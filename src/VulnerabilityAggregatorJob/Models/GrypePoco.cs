using System;
using System.Collections.Generic;

namespace VulnerabilityAggregatorJob.Models
{
    public class Match
    {
        public Vulnerability? Vulnerability { get; set; }
        public List<MatchDetail> MatchDetails { get; set; } = new List<MatchDetail>();
        public Artifact Artifact { get; set; } = new Artifact();
    }

    public class Vulnerability
    {
        public string? Id { get; set; }
        public string? Severity { get; set; }
        public string? Description { get; set; }
        public string? DataSource { get; set; }
        public string? Namespace { get; set; }
        public List<Cvss> Cvss { get; set; } = new List<Cvss>();
        public Fix Fix { get; set; } = new Fix();
    }

    public class Artifact
    {
        public string? Id { get; set; }
        public string? Name { get; set; }
        public string? Version { get; set; }
        public string? Type { get; set; }
    }

    public class Cvss
    {
        public string? Version { get; set; }
        public string? Vector { get; set; }
        public CvssMetrics Metrics { get; set; } = new CvssMetrics();
        public VendorMetadata VendorMetadata { get; set; } = new VendorMetadata();
    }

    public class CvssMetrics
    {
        public double BaseScore { get; set; }
        public double ExploitabilityScore { get; set; }
        public double ImpactScore { get; set; }
    }

    public class VendorMetadata
    {
        public string? BaseSeverity { get; set; }
        public string? Status { get; set; }
    }

    public class Fix
    {
        public List<string> Versions { get; set; } = new List<string>();
        public string? State { get; set; }
    }

    public class MatchDetail
    {
        public string? Type { get; set; }
        public string? Matcher { get; set; }
        public SearchedBy SearchedBy { get; set; } = new SearchedBy();
        public Found Found { get; set; } = new Found();
    }

    public class SearchedBy
    {
        public string? Language { get; set; }
        public string? Namespace { get; set; }
        public Package Package { get; set; } = new Package();
    }

    public class Package
    {
        public string? Name { get; set; }
        public string? Version { get; set; }
    }

    public class Found
    {
        public string? VersionConstraint { get; set; }
        public string? VulnerabilityID { get; set; }
    }

    public class MatchesRoot
    {
        public List<Match> Matches { get; set; } = new List<Match>();
    }
}
